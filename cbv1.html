<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paypoint Help Center | ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-tertiary: #94a3b8;
            --border-color: #e2e8f0;
            --accent-color: #3b82f6;
            --accent-hover: #2563eb;
            --accent-light: #eff6ff;
        }
        body.dark {
            --bg-primary: #1e293b;
            --bg-secondary: #334155;
            --bg-tertiary: #475569;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border-color: #475569;
        }
        body { 
            font-family: 'Prompt', sans-serif; 
            background-color: var(--bg-secondary); 
            color: var(--text-primary);
            line-height: 1.6;
        }
        .bg-dynamic-primary { background-color: var(--bg-primary); }
        .bg-dynamic-secondary { background-color: var(--bg-secondary); }
        .bg-dynamic-tertiary { background-color: var(--bg-tertiary); }
        .text-dynamic-primary { color: var(--text-primary); }
        .text-dynamic-secondary { color: var(--text-secondary); }
        .text-dynamic-tertiary { color: var(--text-tertiary); }
        .border-dynamic { border-color: var(--border-color); }
        
        .loader { 
            border: 3px solid var(--border-color); 
            border-radius: 50%; 
            border-top: 3px solid var(--accent-color); 
            width: 32px; 
            height: 32px; 
            animation: spin 1s linear infinite; 
        }
        @keyframes spin { 
            0% { transform: rotate(0deg); } 
            100% { transform: rotate(360deg); } 
        }
        
        #chatContainer { 
            height: 60vh; 
            min-height: 400px; 
        }
        .msg-row { 
            display: flex; 
            margin-bottom: 1rem; 
            animation: fadeIn 0.3s ease-in-out; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        
        .msg-bubble { 
            max-width: 80%; 
            padding: 1rem 1.25rem; 
            border-radius: 1.25rem; 
            position: relative; 
            line-height: 1.6; 
            word-wrap: break-word; 
        }
        .msg-bot { 
            background-color: var(--bg-primary); 
            color: var(--text-primary); 
            border-bottom-left-radius: 0.25rem; 
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08); 
        }
        .msg-user { 
            background-color: var(--accent-color); 
            color: white; 
            border-bottom-right-radius: 0.25rem; 
            margin-left: auto; 
        }
        
        .suggestion-btn { 
            display: inline-block; 
            margin: 4px 4px 4px 0; 
            padding: 8px 14px; 
            background-color: var(--accent-light); 
            color: var(--accent-color); 
            border: 1px solid #bfdbfe; 
            border-radius: 9999px; 
            font-size: 0.875rem; 
            cursor: pointer; 
            transition: all 0.2s; 
        }
        .suggestion-btn:hover { 
            background-color: #dbeafe; 
            transform: translateY(-1px); 
        }
        
        .msg-bot a { 
            color: var(--accent-color); 
            text-decoration: underline; 
            font-weight: 500; 
        }
        .msg-bot a:hover { 
            color: var(--accent-hover); 
        }

        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏∏‡πà‡∏° */
        .random-questions-card {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .question-item {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: #1f2937;
        }
        .question-item:hover {
            background-color: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .question-number {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 28px;
            height: 28px;
            background-color: rgba(59, 130, 246, 0.7);
            border-radius: 50%;
            margin-right: 0.75rem;
            font-weight: 600;
            font-size: 0.875rem;
            color: white;
        }
        .refresh-btn {
            background-color: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.9);
            color: #1f2937;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .refresh-btn:hover { 
            background-color: rgba(255, 255, 255, 0.9); 
        }

        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ */
        .stats-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        .stat-item {
            text-align: center;
        }
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-color);
        }
        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ */
        .btn-base { 
            padding: 0.5rem 1rem; 
            border-radius: 0.5rem; 
            font-size: 0.875rem; 
            cursor: pointer; 
            transition: all 0.3s; 
            border: none; 
            display: inline-flex; 
            align-items: center; 
            gap: 0.5rem; 
        }
        .notification { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background-color: white; 
            color: #1f2937; 
            padding: 1rem 1.25rem; 
            border-radius: 0.5rem; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); 
            z-index: 1000; 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
            transform: translateX(400px); 
            transition: transform 0.3s; 
            max-width: 350px; 
        }
        .notification.show { 
            transform: translateX(0); 
        }
        .typing-indicator { 
            display: inline-flex; 
            align-items: center; 
            gap: 4px; 
        }
        .typing-indicator span { 
            width: 8px; 
            height: 8px; 
            background-color: var(--accent-color); 
            border-radius: 50%; 
            animation: typing 1.4s infinite; 
        }
        .typing-indicator span:nth-child(2) { 
            animation-delay: 0.2s; 
        }
        .typing-indicator span:nth-child(3) { 
            animation-delay: 0.4s; 
        }
        @keyframes typing { 
            0%, 60%, 100% { transform: translateY(0); } 
            30% { transform: translateY(-10px); } 
        }
        .history-container { 
            background-color: var(--bg-primary); 
            border-radius: 0.75rem; 
            padding: 1.25rem; 
            margin-bottom: 1.5rem; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); 
            border: 1px solid var(--border-color); 
        }
        .history-item { 
            padding: 0.75rem; 
            border-bottom: 1px solid var(--border-color); 
            cursor: pointer; 
            transition: all 0.2s; 
            border-radius: 0.5rem; 
        }
        .history-item:hover { 
            background-color: var(--bg-secondary); 
        }
        .history-item:last-child { 
            border-bottom: none; 
        }
        .history-time { 
            font-size: 0.75rem; 
            color: var(--text-secondary); 
        }
        .clear-history-btn { 
            background-color: #f59e0b; 
            color: white; 
        }
        .clear-history-btn:hover { 
            background-color: #d97706; 
        }
        .admin-btn { 
            position: fixed; 
            bottom: 20px; 
            right: 20px; 
            background-color: #f59e0b; 
            color: white; 
            width: 56px; 
            height: 56px; 
            border-radius: 50%; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); 
            cursor: pointer; 
            transition: all 0.3s; 
            z-index: 999; 
        }
        .admin-btn:hover { 
            background-color: #d97706; 
            transform: scale(1.1); 
        }
        .rating-container { 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
            margin-top: 1rem; 
            flex-wrap: wrap; 
        }
        .rating-btn { 
            padding: 0.5rem 0.75rem; 
            border-radius: 0.375rem; 
            font-size: 0.875rem; 
            cursor: pointer; 
            transition: all 0.2s; 
            border: 1px solid var(--border-color); 
            background-color: var(--bg-primary); 
            color: var(--text-primary); 
        }
        .rating-btn:hover { 
            background-color: var(--bg-secondary); 
        }
        .rating-btn.active { 
            background-color: var(--accent-color); 
            color: white; 
            border-color: var(--accent-color); 
        }
        .sr-only { 
            position: absolute; 
            width: 1px; 
            height: 1px; 
            padding: 0; 
            margin: -1px; 
            overflow: hidden; 
            clip: rect(0, 0, 0, 0); 
            white-space: nowrap; 
            border-width: 0; 
        }
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡πà‡∏ß‡∏ô PDPA */
        .pdpa-info {
            font-size: 0.7rem;
            line-height: 1.4;
            color: #9ca3af;
            pointer-events: none;
        }
    </style>
</head>
<body class="text-gray-800 transition-colors duration-300">
    <!-- Notification -->
    <div id="notification" class="notification" role="alert" aria-live="assertive">
        <span class="material-icons">notifications</span>
        <span id="notificationText">‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà</span>
    </div>

    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-blue-800 text-white py-12 px-4 shadow-lg relative overflow-hidden">
        <div class="absolute top-0 right-0 p-4 opacity-10">
            <svg width="200" height="200" fill="currentColor" viewBox="0 0 24 24"><path d="M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
        </div>
        <div class="max-w-4xl mx-auto text-center relative z-10">
            <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0o9dy2uhW38GNxBXXHg4HiSPX15dXO3NMX1kOG0xJc7Tpmva2s_vqh_3cz3jA-2DFDOGzv3cJcg3BR06tW2CzOFzCDVkcMEYQpm6TKzaGWLnHUZAnFpWzS-LW6HFcSB7g-ENiGlmYDcP74K33dOokl3ZJOlpeILfS2xIA9LS8IpJA_-umKp-ssSe_oGo/w200-h96/PAYPOINT%20_111.png" alt="Paypoint Logo" class="h-20 mx-auto mb-6">
            <h1 class="text-3xl md:text-4xl font-bold mb-4">Paypoint Help Center</h1>
            <p class="text-blue-100 mb-8 font-light">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏ó‡∏±‡∏ô‡πÉ‡∏à</p>
            <div class="flex flex-wrap justify-center gap-3">
                <a href="https://tuikub.github.io/paypoint/#home" target="_blank" class="bg-blue-700 hover:bg-blue-600 border border-blue-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2"><span class="material-icons text-base">menu_book</span> ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</a>
                <a href="https://tuikub.github.io/tracking/" target="_blank" class="bg-blue-700 hover:bg-blue-600 border border-blue-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2"><span class="material-icons text-base">local_shipping</span> ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏•‡∏Ç</a>
                <a href="https://lin.ee/Lr1qLQx" target="_blank" class="bg-blue-700 hover:bg-blue-600 border border-blue-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2"><span class="material-icons text-base">support_agent</span> ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</a>
                <a href="https://tuikub.github.io/tracking/f.html" target="_blank" class="bg-blue-700 hover:bg-blue-600 border border-blue-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2"><span class="material-icons text-base">help_outline</span> ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</a>
                <a href="https://www.youtube.com/channel/UC0IEG_tOt1Hrj4FXDbkZN-A" target="_blank" class="bg-red-600 hover:bg-red-700 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2"><span class="material-icons text-base">smart_display</span> ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° YouTube</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto py-10 px-4">
        <!-- Visitor Stats -->
        <section class="stats-card fade-in">
            <div class="flex justify-between items-center mb-3">
                <h3 class="font-semibold text-dynamic-primary text-lg flex items-center gap-2">
                    <span class="material-icons text-blue-600">analytics</span>
                    ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°
                </h3>
                <button id="resetStatsBtn" class="btn-base text-sm text-red-600 hover:bg-red-50" title="‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)">
                    <span class="material-icons text-base">refresh</span>
                </button>
            </div>
            <div class="grid grid-cols-3 gap-4 text-center">
                <div class="stat-item">
                    <div id="todayVisits" class="stat-number">-</div>
                    <div class="stat-label">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                </div>
                <div class="stat-item">
                    <div id="monthVisits" class="stat-number">-</div>
                    <div class="stat-label">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>
                </div>
                <div class="stat-item">
                    <div id="totalVisits" class="stat-number">-</div>
                    <div class="stat-label">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
            </div>
        </section>

        <!-- Random Questions Section -->
        <section id="randomQuestionsSection" class="mb-6 fade-in">
            <div class="random-questions-card">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold flex items-center gap-2 text-white"><span class="material-icons">lightbulb</span> ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à</h2>
                    <button id="refreshQuestions" class="refresh-btn"><span class="material-icons">refresh</span> ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
                </div>
                <div id="randomQuestionsList">
                    <!-- Random questions will be loaded here -->
                </div>
            </div>
        </section>

        <!-- History Section -->
        <section id="historySection" class="history-container fade-in">
            <div class="flex justify-between items-center mb-3">
                <h3 class="font-semibold text-dynamic-primary text-lg">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                <button id="clearHistory" class="btn-base clear-history-btn"><span class="material-icons text-base">delete_sweep</span> ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
            </div>
            <div id="historyList" class="text-dynamic-secondary"></div>
        </section>

        <!-- Chat Interface -->
        <div class="bg-dynamic-secondary rounded-2xl shadow-xl overflow-hidden border border-dynamic flex flex-col fade-in">
            <div id="chatContainer" class="p-6 overflow-y-auto">
                <div id="loading" class="flex flex-col items-center justify-center py-10">
                    <div class="loader mb-4"></div>
                    <p class="text-dynamic-secondary text-sm">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>
            </div>
            <div class="bg-dynamic-primary p-4 border-t border-dynamic">
                <form id="chatForm" class="flex gap-2 relative items-center">
                    <button type="button" id="clearBtn" class="text-dynamic-secondary p-3 rounded-full hover:bg-dynamic-secondary hover:text-dynamic-primary transition-colors" title="‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ä‡∏ó"><span class="material-icons">clear</span></button>
                    <button type="button" id="shareHistoryBtn" class="text-dynamic-secondary p-3 rounded-full hover:bg-dynamic-secondary hover:text-dynamic-primary transition-colors" title="‡πÅ‡∏ä‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥"><span class="material-icons">share</span></button>
                    <button type="button" id="notificationToggle" class="text-dynamic-secondary p-3 rounded-full hover:text-red-500 transition-colors" title="‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"><span class="material-icons" id="notificationIcon">notifications</span></button>
                    <button type="button" id="darkModeToggle" class="text-dynamic-secondary p-3 rounded-full hover:text-dynamic-primary transition-colors" title="‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î/‡∏™‡∏ß‡πà‡∏≤‡∏á"><span class="material-icons" id="darkModeIcon">dark_mode</span></button>
                    <button type="button" id="imageUploadBtn" class="text-dynamic-secondary p-3 rounded-full hover:text-red-500 transition-colors" title="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"><span class="material-icons">image</span></button>
                    <button type="button" id="voiceSearchBtn" class="text-dynamic-secondary p-3 rounded-full hover:text-red-500 transition-colors" title="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á"><span class="material-icons">mic</span></button>
                    <input type="text" id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." class="flex-1 py-3 px-5 rounded-full bg-dynamic-secondary text-dynamic-primary placeholder-dynamic-secondary border-transparent focus:bg-dynamic-primary focus:border-dynamic focus:ring-0 transition-all outline-none" autocomplete="off" disabled>
                    <button type="submit" id="sendBtn" class="bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled><span class="material-icons">send</span></button>
                </form>
                <input type="file" id="imageInput" accept="image/*" class="hidden" aria-label="‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û">
            </div>
        </div>
    </main>

    <!-- Admin Button -->
    <div id="adminBtn" class="admin-btn" title="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£"><span class="material-icons">admin_panel_settings</span></div>

    <!-- Footer with PDPA -->
    <footer class="bg-gray-900 text-gray-300 py-8 px-4 mt-12">
        <div class="max-w-4xl mx-auto text-center">
            <p class="mb-2 text-sm">¬© 2024 Paypoint System. ‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
            <p class="pdpa-info mb-4">‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° ‡∏î‡∏π‡πÅ‡∏• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡πÇ‡∏î‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡∏û.‡∏®. 2562 (PDPA)</p>
            <p class="pdpa-info font-semibold">‡∏ú‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•: ‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏±‡∏ä‡∏ç‡∏≤ ‡∏ä‡∏≤‡∏ï‡∏£‡∏µ | Email: pratya.tui@gmail.com</p>
        </div>
    </footer>

    <script>
        // --- CONFIGURATION & STATE ---
        const CONFIG = { 
            SHEET_URL: `https://docs.google.com/spreadsheets/d/e/2PACX-1vSqBNUzZV0YU0IgQHm2s9KMu7UZ1D8m3fLBkfnyl_kFcsN2c7GOmKOziiZvExrTxfkgnv5d2OIn08JO/pub?output=csv`,
            ADMIN_PASSWORD: 'admin123'
        };
        const state = { faqData: [], searchHistory: [], fuse: null, notificationsEnabled: true, darkMode: false, isProcessing: false };
        const elements = { 
            chatContainer: document.getElementById('chatContainer'), 
            chatInput: document.getElementById('chatInput'), 
            chatForm: document.getElementById('chatForm'), 
            sendBtn: document.getElementById('sendBtn'), 
            clearBtn: document.getElementById('clearBtn'), 
            loading: document.getElementById('loading'), 
            randomQuestionsList: document.getElementById('randomQuestionsList'), 
            refreshQuestionsBtn: document.getElementById('refreshQuestions'), 
            notification: document.getElementById('notification'), 
            notificationText: document.getElementById('notificationText'), 
            notificationToggle: document.getElementById('notificationToggle'), 
            notificationIcon: document.getElementById('notificationIcon'), 
            darkModeToggle: document.getElementById('darkModeToggle'), 
            darkModeIcon: document.getElementById('darkModeIcon'), 
            imageUploadBtn: document.getElementById('imageUploadBtn'), 
            imageInput: document.getElementById('imageInput'), 
            voiceSearchBtn: document.getElementById('voiceSearchBtn'), 
            adminBtn: document.getElementById('adminBtn'), 
            historySection: document.getElementById('historySection'), 
            historyList: document.getElementById('historyList'), 
            clearHistoryBtn: document.getElementById('clearHistory'), 
            shareHistoryBtn: document.getElementById('shareHistoryBtn'), 
            resetStatsBtn: document.getElementById('resetStatsBtn'), 
            todayVisits: document.getElementById('todayVisits'), 
            monthVisits: document.getElementById('monthVisits'), 
            totalVisits: document.getElementById('totalVisits') 
        };

        // --- VISITOR STATISTICS ---
        function updateVisitorStats() {
            const now = new Date();
            const today = now.toDateString();
            const thisMonth = now.getMonth();
            const thisYear = now.getFullYear();

            // Check if it's a new session
            if (!sessionStorage.getItem('sessionActive')) {
                sessionStorage.setItem('sessionActive', 'true');
                
                let stats = JSON.parse(localStorage.getItem('visitorStats')) || {
                    total: 0,
                    daily: {},
                    monthly: {}
                };

                // Increment total
                stats.total++;

                // Increment daily
                if (!stats.daily[today]) {
                    stats.daily[today] = 0;
                }
                stats.daily[today]++;

                // Increment monthly
                const monthKey = `${thisYear}-${thisMonth}`;
                if (!stats.monthly[monthKey]) {
                    stats.monthly[monthKey] = 0;
                }
                stats.monthly[monthKey]++;

                localStorage.setItem('visitorStats', JSON.stringify(stats));
            }
            
            displayStats();
        }

        function displayStats() {
            const stats = JSON.parse(localStorage.getItem('visitorStats')) || { total: 0, daily: {}, monthly: {} };
            const now = new Date();
            const today = now.toDateString();
            const monthKey = `${now.getFullYear()}-${now.getMonth()}`;

            elements.todayVisits.textContent = stats.daily[today] || 0;
            elements.monthVisits.textContent = stats.monthly[monthKey] || 0;
            elements.totalVisits.textContent = stats.total;
        }

        function resetStats() {
            const password = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥:');
            if (password === CONFIG.ADMIN_PASSWORD) {
                localStorage.removeItem('visitorStats');
                displayStats();
                showNotification('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            } else if (password !== null) {
                showNotification('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
            }
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            updateVisitorStats();
            initializeApp();
        });

        // ... (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ...
        async function initializeApp() {
            loadSettings(); 
            loadSearchHistory(); 
            setupEventListeners(); 
            requestNotificationPermission();
            displayRandomQuestions();
            await fetchFAQ();
        }
        
        async function fetchFAQ() {
            state.faqData = flattenFaqData(rawFaqData);
            try {
                const response = await fetch(CONFIG.SHEET_URL + '&t=' + new Date().getTime());
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.text();
                if (!data.trim().startsWith('<!DOCTYPE')) {
                    const sheetData = parseCSV(data);
                    if (sheetData.length > 0) {
                        state.faqData = [...state.faqData, ...sheetData];
                        showNotification(`‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${state.faqData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                    }
                }
            } catch (error) {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets:', error);
                showNotification('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: ' + error.message);
            } finally {
                initializeFuse();
                finalizeAppInitialization();
                displayRandomQuestions();
            }
        }
        
        function finalizeAppInitialization() {
            elements.loading.remove(); 
            enableChat();
            addBotMessage("‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠ Paypoint Bot ü§ñ<br>‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö? ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
            checkForNewData();
        }

        const rawFaqData = [ /* ... (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• FAQ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ... */ ];
        
        function setupEventListeners() {
            elements.chatForm.addEventListener('submit', (e) => { e.preventDefault(); const text = elements.chatInput.value.trim(); if (!text) return; addUserMessage(text); elements.chatInput.value = ''; processQuery(text); });
            elements.clearBtn.addEventListener('click', clearChat);
            elements.refreshQuestionsBtn.addEventListener('click', () => { displayRandomQuestions(); elements.randomQuestionsList.style.opacity = '0'; setTimeout(() => { elements.randomQuestionsList.style.opacity = '1'; }, 100); });
            elements.notificationToggle.addEventListener('click', toggleNotifications);
            elements.darkModeToggle.addEventListener('click', toggleDarkMode);
            elements.imageUploadBtn.addEventListener('click', () => elements.imageInput.click());
            elements.voiceSearchBtn.addEventListener('click', toggleVoiceSearch);
            elements.adminBtn.addEventListener('click', handleAdminLogin);
            elements.clearHistoryBtn.addEventListener('click', clearSearchHistory);
            elements.shareHistoryBtn.addEventListener('click', shareHistory);
            elements.imageInput.addEventListener('change', handleImageUpload);
            elements.resetStatsBtn.addEventListener('click', resetStats);
        }
        
        // ... (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ...
        function addBotMessage(htmlContent, actions = []) { /* ... */ }
        function addUserMessage(text) { /* ... */ }
        function addTypingIndicator() { /* ... */ }
        function removeTypingIndicator() { /* ... */ }
        function scrollToBottom() { /* ... */ }
        function escapeHtml(text) { /* ... */ }
        async function processQuery(query) { /* ... */ }
        function displaySingleResult(item) { /* ... */ }
        function displayMultipleResults(matches) { /* ... */ }
        function clearChat() { /* ... */ }
        function toggleNotifications() { /* ... */ }
        function toggleDarkMode() { /* ... */ }
        function toggleVoiceSearch() { /* ... */ }
        function handleImageUpload(e) { /* ... */ }
        function handleAdminLogin() { /* ... */ }
        function clearSearchHistory() { /* ... */ }
        function shareHistory() { /* ... */ }
        function showNotification(message) { /* ... */ }
        function loadSettings() { /* ... */ }
        function loadSearchHistory() { /* ... */ }
        function saveSearchHistory(query) { /* ... */ }
        function displaySearchHistory() { /* ... */ }
        function enableChat() { /* ... */ }
        function checkForNewData() { /* ... */ }
        function requestNotificationPermission() { /* ... */ }
        window.handleSuggestion = function(question) { /* ... */ };
        window.searchFromHistory = function(query) { /* ... */ };
        window.rateAnswer = function(id, rating) { /* ... */ };
        window.copyToClipboard = function(text) { /* ... */ };
        function displayRandomQuestions() { /* ... */ }
        function getRandomQuestions(count = 5) { /* ... */ }
        window.handleRandomQuestion = function (question) { /* ... */ };
        function flattenFaqData(nestedData) { /* ... */ }
        function parseCSV(csvText) { /* ... */ }
        function initializeFuse() { /* ... */ }
    </script>
</body>
</html>
