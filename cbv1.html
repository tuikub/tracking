<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paypoint Help Center | ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</title>
    <!-- Tailwind CSS for modern UI -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font: Prompt (‡∏ô‡∏¥‡∏¢‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ó‡∏¢‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏´‡∏°‡πà) -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #f8fafc;
        }
        .bg-primary-dark { background-color: #1f2937; }
        .bg-primary { background-color: #374151; }
        .text-primary { color: #1f2937; }
        
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #ef4444;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Chat Specific Styles */
        #chatContainer {
            height: 60vh;
            min-height: 400px;
        }
        .msg-row {
            display: flex;
            margin-bottom: 1rem;
        }
        .msg-bubble {
            max-width: 80%;
            padding: 1rem;
            border-radius: 1rem;
            position: relative;
            line-height: 1.5;
        }
        .msg-bot {
            background-color: white;
            color: #1f2937;
            border-bottom-left-radius: 0.25rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .msg-user {
            background-color: #ef4444;
            color: white;
            border-bottom-right-radius: 0.25rem;
            margin-left: auto;
        }
        .suggestion-btn {
            display: inline-block;
            margin: 4px 4px 4px 0;
            padding: 6px 12px;
            background-color: #fee2e2;
            color: #b91c1c;
            border: 1px solid #fecaca;
            border-radius: 9999px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .suggestion-btn:hover {
            background-color: #fecaca;
        }
        /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
        .msg-bot a {
            color: #ef4444;
            text-decoration: underline;
        }
        .msg-bot a:hover {
            color: #dc2626;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏∏‡πà‡∏° */
        .random-questions-card {
            background: linear-gradient(135deg, #fca5a5 0%, #f87171 100%);
            color: #1f2937;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .question-item {
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        .question-item:hover {
            background-color: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .question-number {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 28px;
            height: 28px;
            background-color: rgba(239, 68, 68, 0.5);
            border-radius: 50%;
            margin-right: 0.75rem;
            font-weight: 600;
            font-size: 0.875rem;
            color: #1f2937;
        }
        .refresh-btn {
            background-color: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.7);
            color: #1f2937;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .refresh-btn:hover {
            background-color: rgba(255, 255, 255, 0.7);
        }
        /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
        #sendBtn {
            background-color: #ef4444;
        }
        #sendBtn:hover {
            background-color: #dc2626;
        }
        /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ */
        #chatInput:focus {
            border-color: #ef4444;
        }
        /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° */
        .follow-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background-color: #ff0000;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        .follow-link:hover {
            background-color: #cc0000;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: white;
            color: #1f2937;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        .notification.show {
            transform: translateX(0);
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û */
        .image-upload-container {
            position: relative;
            display: inline-block;
        }
        .image-preview {
            max-width: 100px;
            max-height: 100px;
            border-radius: 0.5rem;
            object-fit: cover;
            margin-top: 0.5rem;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î */
        body.dark {
            background-color: #1f2937;
            color: #f9fafb;
        }
        body.dark .msg-bot {
            background-color: #374151;
            color: #f9fafb;
        }
        body.dark .random-questions-card {
            background: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);
        }
        body.dark .question-item {
            background-color: rgba(55, 65, 81, 0.7);
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå */
        .typing-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        .typing-indicator span {
            width: 8px;
            height: 8px;
            background-color: #ef4444;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á */
        #voiceSearchBtn {
            position: absolute;
            right: 50px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            cursor: pointer;
        }
        #voiceSearchBtn:hover {
            color: #ef4444;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ */
        #imageUploadBtn {
            position: absolute;
            right: 90px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            cursor: pointer;
        }
        #imageUploadBtn:hover {
            color: #ef4444;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î */
        #darkModeToggle {
            position: absolute;
            right: 130px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            cursor: pointer;
        }
        #darkModeToggle:hover {
            color: #ef4444;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô */
        #notificationToggle {
            position: absolute;
            right: 170px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            cursor: pointer;
        }
        #notificationToggle:hover {
            color: #ef4444;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ FAQ */
        #manageFAQBtn {
            background-color: #f59e0b;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        #manageFAQBtn:hover {
            background-color: #d97706;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ FAQ */
        .faq-form {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
        }
        body.dark .faq-form {
            background-color: #374151;
            color: #f9fafb;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á FAQ */
        .faq-table {
            width: 100%;
            border-collapse: collapse;
        }
        .faq-table th, .faq-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        body.dark .faq-table th, 
        body.dark .faq-table td {
            border-bottom-color: #4b5563;
        }
        .faq-table th {
            background-color: #f9fafb;
            font-weight: 600;
        }
        body.dark .faq-table th {
            background-color: #4b5563;
        }
        .faq-table tr:hover {
            background-color: #f9fafb;
        }
        body.dark .faq-table tr:hover {
            background-color: #4b5563;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
        .table-btn {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .edit-btn {
            background-color: #3b82f6;
            color: white;
        }
        .edit-btn:hover {
            background-color: #2563eb;
        }
        .delete-btn {
            background-color: #ef4444;
            color: white;
        }
        .delete-btn:hover {
            background-color: #dc2626;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡∏î‡∏±‡∏• */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal.show {
            display: flex;
        }
        .modal-content {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        body.dark .modal-content {
            background-color: #374151;
            color: #f9fafb;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ô‡πÇ‡∏°‡∏î‡∏±‡∏• */
        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        .form-group input, 
        .form-group textarea, 
        .form-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
        }
        body.dark .form-group input, 
        body.dark .form-group textarea, 
        body.dark .form-group select {
            background-color: #4b5563;
            border-color: #6b7280;
            color: #f9fafb;
        }
        .form-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }
        .btn-primary {
            background-color: #ef4444;
            color: white;
        }
        .btn-primary:hover {
            background-color: #dc2626;
        }
        .btn-secondary {
            background-color: #6b7280;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #4b5563;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô */
        .rating-container {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .rating-btn {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #d1d5db;
            background-color: white;
        }
        body.dark .rating-btn {
            background-color: #4b5563;
            border-color: #6b7280;
            color: #f9fafb;
        }
        .rating-btn:hover {
            background-color: #f3f4f6;
        }
        body.dark .rating-btn:hover {
            background-color: #6b7280;
        }
        .rating-btn.active {
            background-color: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô */
        .history-container {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        body.dark .history-container {
            background-color: #374151;
            color: #f9fafb;
        }
        .history-item {
            padding: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
        }
        body.dark .history-item {
            border-bottom-color: #4b5563;
        }
        .history-item:hover {
            background-color: #f9fafb;
        }
        body.dark .history-item:hover {
            background-color: #4b5563;
        }
        .history-item:last-child {
            border-bottom: none;
        }
        .history-time {
            font-size: 0.75rem;
            color: #6b7280;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ */
        .clear-history-btn {
            background-color: #f59e0b;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }
        .clear-history-btn:hover {
            background-color: #d97706;
        }
    </style>
</head>
<body class="text-gray-800">
    <!-- Notification -->
    <div id="notification" class="notification">
        <span class="material-icons">notifications</span>
        <span id="notificationText">‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà</span>
    </div>

    <!-- Header Section -->
    <header class="bg-gray-800 text-white py-12 px-4 shadow-lg relative overflow-hidden">
        <div class="absolute top-0 right-0 p-4 opacity-10">
            <svg width="200" height="200" fill="currentColor" viewBox="0 0 24 24"><path d="M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
        </div>
        <div class="max-w-4xl mx-auto text-center relative z-10">
            <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0o9dy2uhW38GNxBXXHg4HiSPX15dXO3NMX1kOG0xJc7Tpmva2s_vqh_3cz3jA-2DFDOGzv3cJcg3BR06tW2CzOFzCDVkcMEYQpm6TKzaGWLnHUZAnFpWzS-LW6HFcSB7g-ENiGlmYDcP74K33dOokl3ZJOlpeILfS2xIA9LS8IpJA_-umKp-ssSe_oGo/w200-h96/PAYPOINT%20_111.png" alt="Paypoint Logo" class="h-20 mx-auto mb-6">
            <h1 class="text-3xl md:text-4xl font-bold mb-4">Paypoint Help Center</h1>
            <p class="text-blue-100 mb-8 font-light">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏ó‡∏±‡∏ô‡πÉ‡∏à</p>
            
            <div class="flex flex-wrap justify-center gap-3">
                <a href="https://tuikub.github.io/paypoint/#home" target="_blank" class="bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2">
                    üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠
                </a>
                <a href="https://tuikub.github.io/tracking/" target="_blank" class="bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2">
                    üì¶ ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏•‡∏Ç
                </a>
                <a href="https://lin.ee/Lr1qLQx" target="_blank" class="bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2">
                    üí¨ ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
                </a>
                <a href="https://tuikub.github.io/tracking/f.html" target="_blank" class="bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2">
                    ‚ùì ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢
                </a>
                <a href="https://www.youtube.com/channel/UC0IEG_tOt1Hrj4FXDbkZN-A" target="_blank" class="follow-link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
                    </svg>
                    ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° YouTube
                </a>
                <button id="manageFAQBtn" class="bg-amber-500 hover:bg-amber-600 text-white px-4 py-1.5 rounded-full text-sm transition-all flex items-center gap-2">
                    <span class="material-icons text-sm">edit</span>
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ FAQ
                </button>
            </div>
        </div>
    </header>

    <!-- Content Section -->
    <main class="max-w-4xl mx-auto py-10 px-4">
        
        <!-- FAQ Management Section -->
        <div id="faqManagement" class="hidden">
            <div class="faq-form">
                <h2 class="text-xl font-bold mb-4">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢ (FAQ)</h2>
                <div class="flex justify-between mb-4">
                    <button id="addNewFAQ" class="btn btn-primary">
                        <span class="material-icons text-sm">add</span>
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà
                    </button>
                    <button id="refreshFAQ" class="btn btn-secondary">
                        <span class="material-icons text-sm">refresh</span>
                        ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="faq-table">
                        <thead>
                            <tr>
                                <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                                <th>‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</th>
                                <th>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</th>
                                <th>‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</th>
                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="faqTableBody">
                            <!-- FAQ items will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- History Section -->
        <div id="historySection" class="history-container">
            <div class="flex justify-between items-center mb-2">
                <h3 class="font-semibold">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                <button id="clearHistory" class="clear-history-btn">‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
            </div>
            <div id="historyList">
                <!-- History items will be loaded here -->
            </div>
        </div>
        
        <!-- Random Questions Section -->
        <div id="randomQuestionsSection" class="mb-6">
            <div class="random-questions-card">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        <span class="material-icons">help_outline</span>
                        ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à
                    </h2>
                    <button id="refreshQuestions" class="refresh-btn">
                        <span class="material-icons">refresh</span>
                        ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
                <div id="randomQuestionsList">
                    <!-- Random questions will be loaded here -->
                </div>
            </div>
        </div>
        
        <!-- Chat Interface -->
        <div class="bg-gray-50 rounded-2xl shadow-xl overflow-hidden border border-gray-200 flex flex-col">
            
            <!-- Chat History -->
            <div id="chatContainer" class="p-6 overflow-y-auto bg-slate-100">
                <!-- Loading State (Initial) -->
                <div id="loading" class="flex flex-col items-center justify-center py-10">
                    <div class="loader mb-4"></div>
                    <p class="text-gray-500 text-sm">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>
                <!-- Messages will appear here -->
            </div>

            <!-- Input Area -->
            <div class="bg-white p-4 border-t border-gray-200">
                <form id="chatForm" class="flex gap-2 relative">
                    <button 
                        type="button" 
                        id="clearBtn"
                        class="bg-gray-200 text-gray-600 p-3 rounded-full hover:bg-gray-300 transition-colors"
                        title="‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ä‡∏ó / ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà"
                    >
                        <span class="material-icons">clear</span>
                    </button>
                    <button 
                        type="button" 
                        id="notificationToggle"
                        class="text-gray-500 p-3 rounded-full hover:text-red-500 transition-colors"
                        title="‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"
                    >
                        <span class="material-icons">notifications</span>
                    </button>
                    <button 
                        type="button" 
                        id="darkModeToggle"
                        class="text-gray-500 p-3 rounded-full hover:text-red-500 transition-colors"
                        title="‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î/‡∏™‡∏ß‡πà‡∏≤‡∏á"
                    >
                        <span class="material-icons">dark_mode</span>
                    </button>
                    <button 
                        type="button" 
                        id="imageUploadBtn"
                        class="text-gray-500 p-3 rounded-full hover:text-red-500 transition-colors"
                        title="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"
                    >
                        <span class="material-icons">image</span>
                    </button>
                    <button 
                        type="button" 
                        id="voiceSearchBtn"
                        class="text-gray-500 p-3 rounded-full hover:text-red-500 transition-colors"
                        title="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á"
                    >
                        <span class="material-icons">mic</span>
                    </button>
                    <input 
                        type="text" 
                        id="chatInput"
                        placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." 
                        class="flex-1 py-3 px-5 rounded-full bg-gray-100 border-transparent focus:bg-white focus:border-gray-400 focus:ring-0 transition-all outline-none"
                        autocomplete="off"
                        disabled
                    >
                    <button 
                        type="submit" 
                        id="sendBtn"
                        class="bg-gray-800 text-white p-3 rounded-full hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled
                    >
                        <span class="material-icons">send</span>
                    </button>
                </form>
                <!-- Hidden file input for image upload -->
                <input type="file" id="imageInput" accept="image/*" style="display: none;">
            </div>
        </div>

    </main>

    <!-- FAQ Modal -->
    <div id="faqModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 id="modalTitle" class="text-xl font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà</h2>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <form id="faqForm">
                <div class="form-group">
                    <label for="faqCategory">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <select id="faqCategory" required>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                        <option value="‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞">‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                        <option value="‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á">‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á</option>
                        <option value="‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏±‡∏™‡∏î‡∏∏">‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏±‡∏™‡∏î‡∏∏</option>
                        <option value="‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô">‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                        <option value="‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠">‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</option>
                        <option value="‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞ COD">‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞ COD</option>
                        <option value="‡∏á‡∏≤‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå">‡∏á‡∏≤‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</option>
                        <option value="‡πÅ‡∏ü‡∏£‡∏ô‡πÑ‡∏ä‡∏™‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°">‡πÅ‡∏ü‡∏£‡∏ô‡πÑ‡∏ä‡∏™‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="faqQuestion">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</label>
                    <input type="text" id="faqQuestion" required>
                </div>
                <div class="form-group">
                    <label for="faqAnswer">‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</label>
                    <textarea id="faqAnswer" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="faqKeywords">‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏∏‡∏•‡∏†‡∏≤‡∏Ñ)</label>
                    <input type="text" id="faqKeywords" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏, tracking, ‡∏Ç‡∏≠‡∏á‡∏ñ‡∏∂‡∏á‡πÑ‡∏´‡∏ô">
                </div>
                <div class="form-group">
                    <label for="faqLink">‡∏•‡∏¥‡∏á‡∏Å‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                    <input type="url" id="faqLink" placeholder="https://example.com">
                </div>
                <div class="form-buttons">
                    <button type="button" id="cancelBtn" class="btn btn-secondary">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="submit" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <footer class="text-center py-10 text-gray-400 text-sm">
        &copy; 2024 Paypoint System. ‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    </footer>

    <script>
        // --- CONFIGURATION ---
        const GEMINI_API_KEY = ''; // <-- ‡πÉ‡∏™‡πà API Key ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
        const SHEET_ID = '13YE50RWDXik5YhrIqB6naWRxfwDFtFVFbtqs-2bH0Hc';
        const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;
        const SHEET_EDIT_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/edit`;
        
        // Data Store
        let faqData = [];
        let allQuestions = [];
        let searchHistory = [];
        let notificationsEnabled = true;
        let darkMode = false;
        let currentEditId = null;
        
        // Elements
        const chatContainer = document.getElementById('chatContainer');
        const chatInput = document.getElementById('chatInput');
        const chatForm = document.getElementById('chatForm');
        const sendBtn = document.getElementById('sendBtn');
        const clearBtn = document.getElementById('clearBtn');
        const loading = document.getElementById('loading');
        const randomQuestionsList = document.getElementById('randomQuestionsList');
        const refreshQuestionsBtn = document.getElementById('refreshQuestions');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');
        const notificationToggle = document.getElementById('notificationToggle');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const imageUploadBtn = document.getElementById('imageUploadBtn');
        const imageInput = document.getElementById('imageInput');
        const voiceSearchBtn = document.getElementById('voiceSearchBtn');
        const manageFAQBtn = document.getElementById('manageFAQBtn');
        const faqManagement = document.getElementById('faqManagement');
        const faqTableBody = document.getElementById('faqTableBody');
        const addNewFAQBtn = document.getElementById('addNewFAQ');
        const refreshFAQBtn = document.getElementById('refreshFAQ');
        const faqModal = document.getElementById('faqModal');
        const modalTitle = document.getElementById('modalTitle');
        const closeModalBtn = document.getElementById('closeModal');
        const faqForm = document.getElementById('faqForm');
        const cancelBtn = document.getElementById('cancelBtn');
        const historySection = document.getElementById('historySection');
        const historyList = document.getElementById('historyList');
        const clearHistoryBtn = document.getElementById('clearHistory');
        
        // Initialize Speech Recognition
        let recognition = null;
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'th-TH';
            recognition.continuous = false;
            recognition.interimResults = false;
            
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                chatInput.value = transcript;
                processQuery(transcript);
            };
            
            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ' + event.error);
            };
        }
        
        // Initialize notification permission
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }
        
        // Initialize app
        window.onload = function() {
            loadSettings();
            loadSearchHistory();
            fetchFAQ();
        };
        
        // Load settings from localStorage
        function loadSettings() {
            notificationsEnabled = localStorage.getItem('notificationsEnabled') !== 'false';
            darkMode = localStorage.getItem('darkMode') === 'true';
            
            if (darkMode) {
                document.body.classList.add('dark');
                darkModeToggle.innerHTML = '<span class="material-icons">light_mode</span>';
            }
            
            if (!notificationsEnabled) {
                notificationToggle.innerHTML = '<span class="material-icons">notifications_off</span>';
            }
        }
        
        // Load search history from localStorage
        function loadSearchHistory() {
            const history = localStorage.getItem('searchHistory');
            if (history) {
                searchHistory = JSON.parse(history);
                displaySearchHistory();
            }
        }
        
        // Save search history to localStorage
        function saveSearchHistory(query) {
            // Remove if already exists
            searchHistory = searchHistory.filter(item => item.query !== query);
            
            // Add to beginning
            searchHistory.unshift({
                query: query,
                timestamp: new Date().toISOString()
            });
            
            // Keep only last 10 items
            searchHistory = searchHistory.slice(0, 10);
            
            // Save to localStorage
            localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
            displaySearchHistory();
        }
        
        // Display search history
        function displaySearchHistory() {
            if (searchHistory.length === 0) {
                historyList.innerHTML = '<p class="text-gray-500 text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>';
                return;
            }
            
            let html = '';
            searchHistory.forEach(item => {
                const date = new Date(item.timestamp);
                const timeString = date.toLocaleDateString('th-TH') + ' ' + date.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });
                
                html += `
                    <div class="history-item" onclick="searchFromHistory('${item.query.replace(/'/g, "\\'")}')">
                        <div>${item.query}</div>
                        <div class="history-time">${timeString}</div>
                    </div>
                `;
            });
            
            historyList.innerHTML = html;
        }
        
        // Search from history
        window.searchFromHistory = function(query) {
            chatInput.value = query;
            processQuery(query);
        };
        
        // Clear search history
        clearHistoryBtn.addEventListener('click', function() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                searchHistory = [];
                localStorage.removeItem('searchHistory');
                displaySearchHistory();
                showNotification('‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            }
        });
        
        // Toggle notifications
        notificationToggle.addEventListener('click', function() {
            notificationsEnabled = !notificationsEnabled;
            localStorage.setItem('notificationsEnabled', notificationsEnabled);
            
            if (notificationsEnabled) {
                notificationToggle.innerHTML = '<span class="material-icons">notifications</span>';
                showNotification('‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
            } else {
                notificationToggle.innerHTML = '<span class="material-icons">notifications_off</span>';
                showNotification('‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
            }
        });
        
        // Toggle dark mode
        darkModeToggle.addEventListener('click', function() {
            darkMode = !darkMode;
            localStorage.setItem('darkMode', darkMode);
            
            if (darkMode) {
                document.body.classList.add('dark');
                darkModeToggle.innerHTML = '<span class="material-icons">light_mode</span>';
            } else {
                document.body.classList.remove('dark');
                darkModeToggle.innerHTML = '<span class="material-icons">dark_mode</span>';
            }
        });
        
        // Toggle FAQ management
        manageFAQBtn.addEventListener('click', function() {
            faqManagement.classList.toggle('hidden');
            if (!faqManagement.classList.contains('hidden')) {
                loadFAQTable();
            }
        });
        
        // Show notification
        function showNotification(message) {
            if (!notificationsEnabled) return;
            
            notificationText.textContent = message;
            notification.classList.add('show');
            
            // Browser notification
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('Paypoint Help Center', {
                    body: message,
                    icon: 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0o9dy2uhW38GNxBXXHg4HiSPX15dXO3NMX1kOG0xJc7Tpmva2s_vqh_3cz3jA-2DFDOGzv3cJcg3BR06tW2CzOFzCDVkcMEYQpm6TKzaGWLnHUZAnFpWzS-LW6HFcSB7g-ENiGlmYDcP74K33dOokl3ZJOlpeILfS2xIA9LS8IpJA_-umKp-ssSe_oGo/w200-h96/PAYPOINT%20_111.png'
                });
            }
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Fetch FAQ data
        async function fetchFAQ() {
            try {
                const response = await fetch(SHEET_URL);
                if (response.ok) {
                    const data = await response.text();
                    faqData = parseCSV(data);
                    allQuestions = faqData.map(item => item.question);
                } else {
                    throw new Error('Failed to fetch FAQ data');
                }
            } catch (error) {
                console.error('Error fetching FAQ:', error);
                showNotification('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• FAQ ‡πÑ‡∏î‡πâ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á');
                // Use backup data
                faqData = getBackupFAQData();
                allQuestions = faqData.map(item => item.question);
            }
            
            // Hide loading and show results
            loading.remove();
            enableChat();
            addBotMessage("‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠ Paypoint Bot ü§ñ<br>‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö? ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
            
            // Display random questions
            displayRandomQuestions();
            
            // Show notification if new data is available
            const lastFetchTime = localStorage.getItem('lastFetchTime');
            const currentTime = new Date().toISOString();
            
            if (!lastFetchTime || new Date(currentTime) - new Date(lastFetchTime) > 86400000) { // 24 hours
                showNotification('‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• FAQ ‡πÉ‡∏´‡∏°‡πà!');
                localStorage.setItem('lastFetchTime', currentTime);
            }
        }
        
        // Parse CSV data
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const result = [];
            
            // Skip header
            for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                
                // Regex to split CSV while respecting quotes
                const regex = /(".*?"|[^",\s]+)(?=\s*,|\s*$)/g;
                const matches = lines[i].match(regex);
                
                if (matches && matches.length >= 4) {
                    const clean = (str) => str.replace(/^"|"$/g, '').trim();
                    result.push({
                        id: i, // Use line number as ID
                        category: clean(matches[0]),
                        question: clean(matches[1]),
                        answer: clean(matches[2]),
                        keywords: clean(matches[3]).split(',').map(k => k.trim()),
                        link: matches[4] ? clean(matches[4]) : ''
                    });
                }
            }
            
            return result;
        }
        
        // Get backup FAQ data
        function getBackupFAQData() {
            return [
                {
                    id: 1,
                    category: "‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
                    question: "‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô / ‡∏Ç‡∏≠‡∏á‡∏ñ‡∏∂‡∏á‡πÑ‡∏´‡∏ô‡πÅ‡∏•‡πâ‡∏ß / ‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç Tracking ‡∏´‡∏ô‡πà‡∏≠‡∏¢",
                    answer: '‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞ ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Å‡∏î‡πÄ‡∏°‡∏ô‡∏π "‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞" ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞: https://tuikub.github.io/tracking/tracking.html',
                    keywords: ["‡πÄ‡∏ä‡πá‡∏Ñ‡∏û‡∏±‡∏™‡∏î‡∏∏", "‡∏Ç‡∏≠‡∏á‡∏ñ‡∏∂‡∏á‡πÑ‡∏´‡∏ô", "tracking"],
                    link: "https://tuikub.github.io/tracking/tracking.html"
                },
                {
                    id: 2,
                    category: "‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á",
                    question: "‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó / ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏û‡∏á‡πÑ‡∏´‡∏° / ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á",
                    answer: '‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏ö‡∏≤‡πÜ ‡πÅ‡∏Ñ‡πà 25 ‡∏ö‡∏≤‡∏ó‡πÄ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞! ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏Ñ‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏î‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: https://tuikub.github.io/paypoint/c.html',
                    keywords: ["‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á", "‡∏£‡∏≤‡∏Ñ‡∏≤", "‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó"],
                    link: "https://tuikub.github.io/paypoint/c.html"
                },
                {
                    id: 3,
                    category: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏±‡∏™‡∏î‡∏∏",
                    question: "‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢ ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÑ‡∏´‡∏° / ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡πÑ‡∏´‡∏°",
                    answer: '‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô (‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2,000 ‡∏ö‡∏≤‡∏ó) ‡∏Ñ‡πà‡∏∞ ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Ç‡∏≠‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏ô‡πÅ‡∏Å‡∏∞‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô: https://tuikub.github.io/tracking/warranty.html',
                    keywords: ["‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡∏Å", "‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢", "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô", "‡πÄ‡∏Ñ‡∏•‡∏°"],
                    link: "https://tuikub.github.io/tracking/warranty.html"
                }
            ];
        }
        
        // Load FAQ table
        function loadFAQTable() {
            faqTableBody.innerHTML = '';
            
            faqData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.category}</td>
                    <td>${item.question}</td>
                    <td>${item.answer.length > 50 ? item.answer.substring(0, 50) + '...' : item.answer}</td>
                    <td>${item.keywords.join(', ')}</td>
                    <td>
                        <button class="table-btn edit-btn" onclick="editFAQ(${item.id})">
                            <span class="material-icons text-sm">edit</span>
                        </button>
                        <button class="table-btn delete-btn" onclick="deleteFAQ(${item.id})">
                            <span class="material-icons text-sm">delete</span>
                        </button>
                    </td>
                `;
                faqTableBody.appendChild(row);
            });
        }
        
        // Edit FAQ
        window.editFAQ = function(id) {
            const item = faqData.find(faq => faq.id === id);
            if (!item) return;
            
            currentEditId = id;
            modalTitle.textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°';
            
            document.getElementById('faqCategory').value = item.category;
            document.getElementById('faqQuestion').value = item.question;
            document.getElementById('faqAnswer').value = item.answer;
            document.getElementById('faqKeywords').value = item.keywords.join(', ');
            document.getElementById('faqLink').value = item.link || '';
            
            faqModal.classList.add('show');
        };
        
        // Delete FAQ
        window.deleteFAQ = function(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                // In a real implementation, you would send a request to the server
                // For this demo, we'll just remove it from the local array
                faqData = faqData.filter(item => item.id !== id);
                loadFAQTable();
                showNotification('‡∏•‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            }
        };
        
        // Show FAQ modal
        addNewFAQBtn.addEventListener('click', function() {
            currentEditId = null;
            modalTitle.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà';
            faqForm.reset();
            faqModal.classList.add('show');
        });
        
        // Close FAQ modal
        closeModalBtn.addEventListener('click', function() {
            faqModal.classList.remove('show');
        });
        
        cancelBtn.addEventListener('click', function() {
            faqModal.classList.remove('show');
        });
        
        // Submit FAQ form
        faqForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const category = document.getElementById('faqCategory').value;
            const question = document.getElementById('faqQuestion').value;
            const answer = document.getElementById('faqAnswer').value;
            const keywords = document.getElementById('faqKeywords').value.split(',').map(k => k.trim());
            const link = document.getElementById('faqLink').value;
            
            if (currentEditId) {
                // Update existing FAQ
                const item = faqData.find(faq => faq.id === currentEditId);
                if (item) {
                    item.category = category;
                    item.question = question;
                    item.answer = answer;
                    item.keywords = keywords;
                    item.link = link;
                }
                showNotification('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            } else {
                // Add new FAQ
                const newId = Math.max(...faqData.map(item => item.id), 0) + 1;
                faqData.push({
                    id: newId,
                    category: category,
                    question: question,
                    answer: answer,
                    keywords: keywords,
                    link: link
                });
                showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            }
            
            // In a real implementation, you would send a request to the server to save the changes
            // For this demo, we'll just update the local array and table
            
            loadFAQTable();
            faqModal.classList.remove('show');
            
            // Refresh random questions
            displayRandomQuestions();
        });
        
        // Refresh FAQ data
        refreshFAQBtn.addEventListener('click', function() {
            fetchFAQ();
            loadFAQTable();
            showNotification('‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• FAQ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
        });
        
        // Display random questions
        function displayRandomQuestions() {
            const randomQuestions = getRandomQuestions(10);
            let html = '';
            
            randomQuestions.forEach((item, index) => {
                const q = item.question.replace(/"/g, '&quot;');
                html += `
                    <div class="question-item" onclick="handleRandomQuestion('${q}')">
                        <span class="question-number">${index + 1}</span>
                        <span>${item.question}</span>
                    </div>
                `;
            });
            
            randomQuestionsList.innerHTML = html;
        }
        
        // Get random questions
        function getRandomQuestions(count = 10) {
            const shuffled = [...faqData].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, Math.min(count, faqData.length));
        }
        
        // Handle random question click
        window.handleRandomQuestion = function(question) {
            document.getElementById('chatContainer').scrollIntoView({ behavior: 'smooth' });
            
            setTimeout(() => {
                addUserMessage(question);
                setTimeout(() => processQuery(question), 500);
            }, 500);
        };
        
        // Refresh random questions
        refreshQuestionsBtn.addEventListener('click', function() {
            displayRandomQuestions();
            randomQuestionsList.style.opacity = '0';
            setTimeout(() => {
                randomQuestionsList.style.opacity = '1';
            }, 100);
        });
        
        // Enable chat
        function enableChat() {
            chatInput.disabled = false;
            sendBtn.disabled = false;
            chatInput.focus();
        }
        
        // Add bot message
        function addBotMessage(htmlContent) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'msg-row';
            msgDiv.innerHTML = `<div class="msg-bubble msg-bot">${htmlContent}</div>`;
            chatContainer.appendChild(msgDiv);
            scrollToBottom();
        }
        
        // Add user message
        function addUserMessage(text) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'msg-row';
            msgDiv.innerHTML = `<div class="msg-bubble msg-user">${text}</div>`;
            chatContainer.appendChild(msgDiv);
            scrollToBottom();
        }
        
        // Add typing indicator
        function addTypingIndicator() {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'msg-row';
            msgDiv.innerHTML = `
                <div class="msg-bubble msg-bot">
                    <div class="typing-indicator">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            `;
            msgDiv.id = 'typing-indicator';
            chatContainer.appendChild(msgDiv);
            scrollToBottom();
        }
        
        // Remove typing indicator
        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.remove();
            }
        }
        
        // Scroll to bottom
        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        
        // Process query
        async function processQuery(query) {
            const term = query.toLowerCase().trim();
            
            // Save to search history
            saveSearchHistory(query);
            
            // Show typing indicator
            addTypingIndicator();
            
            // Find matches
            const matches = faqData.filter(item => {
                // Check keywords first
                if (item.keywords && item.keywords.some(k => k.toLowerCase().includes(term))) {
                    return true;
                }
                // Then check question, answer, and category
                return item.question.toLowerCase().includes(term) || 
                       item.answer.toLowerCase().includes(term) ||
                       item.category.toLowerCase().includes(term);
            });
            
            // Simulate processing delay
            setTimeout(() => {
                removeTypingIndicator();
                
                if (matches.length === 0) {
                    // Try to use AI if no direct match
                    if (GEMINI_API_KEY) {
                        processWithAI(query);
                    } else {
                        addBotMessage("‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ú‡∏°‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏î‡∏π‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö");
                    }
                } else if (matches.length === 1) {
                    const item = matches[0];
                    const formattedAnswer = item.answer.replace(
                        /(https?:\/\/[^\s]+)/g, 
                        '<a href="$1" target="_blank" class="text-blue-600 hover:underline break-all">$1</a>'
                    );
                    
                    let message = `<strong>${item.question}</strong><br><br>${formattedAnswer.replace(/\n/g, '<br>')}`;
                    
                    // Add rating buttons
                    message += `
                        <div class="rating-container">
                            <span>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</span>
                            <button class="rating-btn" onclick="rateAnswer(${item.id}, 'helpful')">
                                <span class="material-icons text-sm">thumb_up</span> ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå
                            </button>
                            <button class="rating-btn" onclick="rateAnswer(${item.id}, 'not-helpful')">
                                <span class="material-icons text-sm">thumb_down</span> ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå
                            </button>
                        </div>
                    `;
                    
                    addBotMessage(message);
                    
                    // Show notification
                    showNotification('‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
                } else {
                    // Multiple matches
                    let html = `‡∏ú‡∏°‡∏û‡∏ö ${matches.length} ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö:<br>`;
                    
                    // Limit to 5 suggestions to avoid clutter
                    matches.slice(0, 5).forEach((item, index) => {
                        const q = item.question.replace(/"/g, '&quot;');
                        html += `<button class="suggestion-btn" onclick="handleSuggestion('${q}')">${item.question}</button>`;
                    });
                    
                    if (matches.length > 5) html += `<br>...‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ`;
                    
                    addBotMessage(html);
                    
                    // Show notification
                    showNotification(`‡∏û‡∏ö ${matches.length} ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á`);
                }
            }, 1000);
        }
        
        // Process with AI
        async function processWithAI(query) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô Paypoint: ${query}`
                            }]
                        }]
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to generate AI response');
                }
                
                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;
                
                addBotMessage(aiResponse);
                showNotification('AI ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß');
            } catch (error) {
                console.error('AI processing error:', error);
                addBotMessage("‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ú‡∏°‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏î‡∏π‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö");
            }
        }
        
        // Rate answer
        window.rateAnswer = function(id, rating) {
            // In a real implementation, you would send this rating to the server
            console.log(`Rated answer ${id} as ${rating}`);
            
            // Update UI
            const ratingBtns = document.querySelectorAll('.rating-btn');
            ratingBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(rating === 'helpful' ? '‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå' : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå')) {
                    btn.classList.add('active');
                }
            });
            
            showNotification('‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
        };
        
        // Handle suggestion button click
        window.handleSuggestion = function(question) {
            addUserMessage(question);
            setTimeout(() => processQuery(question), 500);
        };
        
        // Handle form submission
        chatForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const text = chatInput.value.trim();
            if (!text) return;
            
            addUserMessage(text);
            chatInput.value = '';
            
            processQuery(text);
        });
        
        // Clear chat
        clearBtn.addEventListener('click', function() {
            chatContainer.innerHTML = '';
            addBotMessage("‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠ Paypoint Bot ü§ñ<br>‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö? ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");
            chatInput.focus();
        });
        
        // Voice search
        voiceSearchBtn.addEventListener('click', function() {
            if (!recognition) {
                showNotification('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á');
                return;
            }
            
            if (voiceSearchBtn.innerHTML.includes('mic')) {
                recognition.start();
                voiceSearchBtn.innerHTML = '<span class="material-icons">mic_off</span>';
                voiceSearchBtn.style.color = '#ef4444';
            } else {
                recognition.stop();
                voiceSearchBtn.innerHTML = '<span class="material-icons">mic</span>';
                voiceSearchBtn.style.color = '#6b7280';
            }
        });
        
        // Image search
        imageUploadBtn.addEventListener('click', function() {
            imageInput.click();
        });
        
        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // In a real implementation, you would upload the image to a server for analysis
            // For this demo, we'll just show a placeholder response
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const imageUrl = event.target.result;
                
                addUserMessage('‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                
                // Add image preview
                const msgDiv = document.createElement('div');
                msgDiv.className = 'msg-row';
                msgDiv.innerHTML = `
                    <div class="msg-bubble msg-user">
                        <img src="${imageUrl}" class="image-preview" alt="Uploaded image">
                    </div>
                `;
                chatContainer.appendChild(msgDiv);
                scrollToBottom();
                
                // Simulate image analysis
                addTypingIndicator();
                
                setTimeout(() => {
                    removeTypingIndicator();
                    addBotMessage('‡∏â‡∏±‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡πâ‡∏ß ‡∏î‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏û‡∏±‡∏™‡∏î‡∏∏ ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà <a href="https://lin.ee/Lr1qLQx" target="_blank">LINE</a>');
                    showNotification('‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                }, 2000);
            };
            
            reader.readAsDataURL(file);
        });
        
        // Request notification permission
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    showNotification('‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
                }
            });
        }
    </script>
</body>
</html>
